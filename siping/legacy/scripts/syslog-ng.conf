@version: 3.3
@include "scl.conf"

options { flush_lines (0);
          time_reopen (10);
          log_fifo_size (1000);
          chain_hostnames (off);
          use_dns (yes);
          use_fqdn (yes);
          dns_cache(yes);
          create_dirs (no);
          keep_hostname (yes);
        };

source s_sys { system(); unix-stream ("/dev/log"); internal(); };
source s_network { udp(); };

destination d_cons { file("/dev/console"); };
destination d_mesg { file("/var/log/messages"); };
destination d_auth { file("/var/log/secure"); };
destination d_mail { file("/var/log/maillog"); };
destination d_spol { file("/var/log/spooler"); };
destination d_boot { file("/var/log/boot.log"); };
destination d_cron { file("/var/log/cron"); };
destination d_named { file("/var/log/named.log"); };
destination d_mlal { usertty("*"); };
destination d_network { file("/var/log/network/network.log"); };
destination d_routers { file("/var/log/routers/routers.log"); };
destination d_switches { file("/var/log/switches/switches.log"); };
destination d_was { file("/var/log/was/waS.log"); };

destination d_tbc-hq-asa-01 { file("/var/log/fw/tbc-hq-asa-01.log"); };
destination d_tbc-hq-asa-02 { file("/var/log/fw/tbc-hq-asa-02.log"); };
destination d_tbc-hq-asa-03 { file("/var/log/fw/tbc-hq-asa-03.log"); };
destination d_tbc-hq-asa-04 { file("/var/log/fw/tbc-hq-asa-04.log"); };
destination d_tbc-hq-asa-05 { file("/var/log/fw/tbc-hq-asa-05.log"); };
destination d_tbc-hq-asa-07 { file("/var/log/fw/tbc-hq-asa-07.log"); };
destination d_tbc-atl-asa-01 { file("/var/log/fw/tbc-atl-asa-01.log"); };
destination d_tbc-atl-asa-02 { file("/var/log/fw/tbc-atl-asa-02.log"); };
destination d_tbc-atl-asa-03 { file("/var/log/fw/tbc-atl-asa-03.log"); };
destination d_tbc-atl-asa-04 { file("/var/log/fw/tbc-atl-asa-04.log"); };
destination d_tbc-atl-asa-07 { file("/var/log/fw/tbc-atl-asa-07.log"); };
destination d_tbc-mds-asa-01 { file("/var/log/fw/tbc-mds-asa-01.log"); };
destination d_tbc-mds-asa-03 { file("/var/log/fw/tbc-mds-asa-03.log"); };
destination d_tbc-retail-mia-asa-01 { file("/var/log/fw/tbc-retail-mia-asa-01.log"); };
destination d_tbc-retail-atl-asa-01 { file("/var/log/fw/tbc-retail-atl-asa-01.log"); };
destination d_tbc-mia-cube-01 { file("/var/log/routers/tbc-mia-cube-01.log"); };
destination d_tbc-atl-cube-01 { file("/var/log/routers/tbc-atl-cube-01.log"); };
destination d_tbc-sjc-cube-01 { file("/var/log/routers/tbc-sjc-cube-01.log"); };
destination d_tbc-hq-cube-01 { file("/var/log/routers/tbc-hq-cube-01.log"); };
destination d_tbc-jno-vgw-01 { file("/var/log/routers/tbc-jno-vgw-01.log" perm(0664)); };
destination d_tbc-retail-mia-bar-01 { file("/var/log/barracuda/tbc-retail-mia-bar-01.log"); };
destination d_tbc-retail-atl-bar-01 { file("/var/log/barracuda/tbc-retail-atl-bar-01.log"); };
destination d_tbc-hq-f5-03 { file("/var/log/lb/tbc-hq-f5-03.log"); };


filter f_filter1     { facility(kern); };
filter f_filter2     { level(info) and
                     not (facility(mail)
			or facility(authpriv) or facility(cron)); };
filter f_filter3     { facility(authpriv); };
filter f_filter4     { facility(mail); };
filter f_filter5     { level(emerg); };
filter f_filter6     { facility(uucp) or
                     (facility(news) and level(crit)); };
filter f_filter7     { facility(local7); };
filter f_cron     { facility(cron); };
filter f_named     { program(named); };
filter f_routers     { host(".*2911[Rr].*") or  host(".*VGW.*") or host(".*rt.*"); };
filter f_switches     { host("tbc.*n[57]k.*") or host("tbc.*c6k.*") or host("[Tt][Bb][Cc].*[Ss][Ww].*") or host(".*2911[Ss].*") or host(".*3750.*")
 or host(".*4948.*"); };
filter f_was     { host(".*was.*"); };
filter f_network     { host(10.5.5[56].*) or host(10.119.*); };
filter f_tbc-hq-asa-01 { host("tbc-hq-asa-01.*"); };
filter f_tbc-hq-asa-02 { host("tbc-hq-asa-02.*"); };
filter f_tbc-hq-asa-03 { host("tbc-hq-asa-03.*"); };
filter f_tbc-hq-asa-04 { host("tbc-hq-asa-04.*"); };
filter f_tbc-hq-asa-05 { host("tbc-hq-asa-05.*"); };
filter f_tbc-hq-asa-07 { host("tbc-hq-asa-07.*"); };
filter f_tbc-atl-asa-01 { host("tbc-atl-asa-01.*"); };
filter f_tbc-atl-asa-02 { host("tbc-atl-asa-02.*"); };
filter f_tbc-atl-asa-03 { host("tbc-atl-asa-03.*"); };
filter f_tbc-atl-asa-04 { host("tbc-atl-asa-04.*"); };
filter f_tbc-atl-asa-07 { host("tbc-atl-asa-07.*"); };
filter f_tbc-mds-asa-01 { host("tbc-mds-asa-01.*"); };
filter f_tbc-mds-asa-03 { host("tbc-mds-asa-03.*"); };
filter f_tbc-retail-mia-asa-01 { host("tbc-retail-mia-asa-01.*"); };
filter f_tbc-retail-atl-asa-01 { host("tbc-retail-atl-asa-01.*"); };
filter f_tbc-mia-cube-01 { host("tbc-mia-cube-01.*"); };
filter f_tbc-atl-cube-01 { host("tbc-atl-cube-01.*"); };
filter f_tbc-sjc-cube-01 { host("tbc-sjc-cube-01.*"); };
filter f_tbc-hq-cube-01 { host("tbc-hq-cube-01.*"); };
filter f_tbc-jno-vgw-01 { host("TBC-JNO-VGW-01.*"); };
filter f_tbc-retail-mia-bar-01 { host("tbc-retail-mia-bar-01.*"); };
filter f_tbc-retail-atl-bar-01 { host("tbc-retail-atl-bar-01.*"); };
filter f_tbc-hq-f5-03 { host("tbc-hq-f5-03.*") or host("tbc-hq-f5-03-external.*"); };

#log { source(s_sys); filter(f_filter1); destination(d_cons); };

log { source(s_network); filter(f_tbc-hq-asa-01); destination(d_tbc-hq-asa-01); flags(final); };
log { source(s_network); filter(f_tbc-hq-asa-02); destination(d_tbc-hq-asa-02); flags(final); };
log { source(s_network); filter(f_tbc-hq-asa-03); destination(d_tbc-hq-asa-03); flags(final); };
log { source(s_network); filter(f_tbc-hq-asa-04); destination(d_tbc-hq-asa-04); flags(final); };
log { source(s_network); filter(f_tbc-hq-asa-05); destination(d_tbc-hq-asa-05); flags(final); };
log { source(s_network); filter(f_tbc-hq-asa-07); destination(d_tbc-hq-asa-07); flags(final); };
log { source(s_network); filter(f_tbc-atl-asa-01); destination(d_tbc-atl-asa-01); flags(final); };
log { source(s_network); filter(f_tbc-atl-asa-02); destination(d_tbc-atl-asa-02); flags(final); };
log { source(s_network); filter(f_tbc-atl-asa-03); destination(d_tbc-atl-asa-03); flags(final); };
log { source(s_network); filter(f_tbc-atl-asa-04); destination(d_tbc-atl-asa-04); flags(final); };
log { source(s_network); filter(f_tbc-atl-asa-07); destination(d_tbc-atl-asa-07); flags(final); };
log { source(s_network); filter(f_tbc-mds-asa-01); destination(d_tbc-mds-asa-01); flags(final); };
log { source(s_network); filter(f_tbc-mds-asa-03); destination(d_tbc-mds-asa-03); flags(final); };
log { source(s_network); filter(f_tbc-retail-mia-asa-01); destination(d_tbc-retail-mia-asa-01); flags(final); };
log { source(s_network); filter(f_tbc-retail-atl-asa-01); destination(d_tbc-retail-atl-asa-01); flags(final); };
log { source(s_network); filter(f_tbc-mia-cube-01); destination(d_tbc-mia-cube-01); flags(final); };
log { source(s_network); filter(f_tbc-atl-cube-01); destination(d_tbc-atl-cube-01); flags(final); };
log { source(s_network); filter(f_tbc-sjc-cube-01); destination(d_tbc-sjc-cube-01); flags(final); };
log { source(s_network); filter(f_tbc-hq-cube-01); destination(d_tbc-hq-cube-01); flags(final); };
log { source(s_network); filter(f_tbc-jno-vgw-01); destination(d_tbc-jno-vgw-01); flags(final); };
log { source(s_network); filter(f_tbc-retail-mia-bar-01); destination(d_tbc-retail-mia-bar-01); flags(final); };
log { source(s_network); filter(f_tbc-retail-atl-bar-01); destination(d_tbc-retail-atl-bar-01); flags(final); };
log { source(s_network); filter(f_tbc-hq-f5-03); destination(d_tbc-hq-f5-03); flags(final); };
log { source(s_network); filter(f_routers); destination(d_routers); flags(final); };
log { source(s_network); filter(f_switches); destination(d_switches); flags(final); };
log { source(s_network); filter(f_was); destination(d_was); flags(final); };
log { source(s_network); filter(f_network); destination(d_network); flags(final); };
log { source(s_sys); filter(f_named); destination(d_named); flags(final); };
log { source(s_sys); filter(f_cron); destination(d_cron); flags(final); };
log { source(s_sys); filter(f_filter2); destination(d_mesg); };
log { source(s_sys); filter(f_filter3); destination(d_auth); };
log { source(s_sys); filter(f_filter4); destination(d_mail); };
log { source(s_sys); filter(f_filter5); destination(d_mlal); };
log { source(s_sys); filter(f_filter6); destination(d_spol); };
log { source(s_sys); filter(f_filter7); destination(d_boot); };
